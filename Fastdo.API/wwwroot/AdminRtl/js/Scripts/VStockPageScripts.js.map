{"version":3,"file":"VStockPageScripts.js","sourceRoot":"","sources":["VStockPageScripts.ts"],"names":[],"mappings":"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","sourcesContent":["(function () {\n    const $tableLoadingEl = $('.vstockPageSection .ContainerOverlay').eq(0);\n    const $tableDomEl = $('#vstockTable');\n\n\n    const vstockConfig = {\n        _modal: $('#modal'),\n        _innerTable: $('#innerTable'),\n        _tableCounter: 0,\n        _modalTitle: $('#modal .modal-title'),\n        _modalBody: $('#modal .modal-body'),\n        _dataTable: null as any as DataTables.DataTable,\n        getNewInnerTable(data: IVStockDrug) {\n            this._tableCounter += 1;\n            var newTb = this._innerTable.clone();\n            newTb.removeClass('d-none');\n            newTb.attr('id', `vstockTable_${this._tableCounter}`);\n            newTb.DataTable({\n                data: data.products,\n                columnDefs: [\n                    {\n                        targets: 0,\n                        data: \"pharmacyName\",\n                        className: 'text-nowrap'\n                    },\n                    {\n                        targets: 1,\n                        data: 'quantity',\n                        className: 'text-nowrap'\n                    },\n                    {\n                        targets: 2,\n                        data: 'discount',\n                        className: 'text-nowrap',\n                        render(val) {\n                            return drugHelperFunctions.getDiscount(val)\n                        }\n                    },\n                    {\n                        targets: 3,\n                        data: 'valideDate',\n                        className: 'text-nowrap',\n                        render(val: Date) {\n                            val = new Date(val);\n                            return `${val.getMonth()} / ${val.getFullYear()}`\n                        }\n                    },\n                    {\n                        targets: 4,\n                        data: 'priceType',\n                        className: 'text-nowrap',\n                        render(val: LzDrugPriceType) {\n                            return drugHelperFunctions.getPriceType(val);\n                        }\n                    },\n                    {\n                        targets: 5,\n                        data: 'desc'\n                    }\n                ]\n            })\n            return newTb.get(0).outerHTML;\n        },\n        get _columnDefs() {\n            const _this = this;\n            return [\n                {\n                    targets: 0,\n                    data: 'name'\n                },\n                {\n                    orderable: false,\n                    targets: 1,\n                    data: 'type'\n                },\n                {\n                    orderable: false,\n                    targets: 2,\n                    data: null,\n                    render(val, t, rowData: IVStockDrug) {\n                        return vStockHelperFunctions.getTotalPriceInStringFormate(rowData);\n                    }\n                },\n                {\n                    orderable: false,\n                    targets: 3,\n                    data: null,\n                    render(val, t, rowData: IVStockDrug) {\n                        return `${rowData.products.length} صيدلية`;\n                    }\n                },\n                {\n                    orderable: false,\n                    targets: 4,\n                    data: null,\n                    render(row: IVStockDrug, type: string, d, meta) {\n                        return _this.makeDetailsColumn(row, meta.row);\n                    }\n                }\n            ] as DataTables.ColumnDefsSettings[]\n        },\n        handleDetailsColumnActions(dt: DataTables.DataTable) {\n            const _this = this;\n            $(document).on('click', '.showVstockDetailsBtn', function () {\n                const $btn = $(this);\n\n                var tr = $btn.closest('tr');\n                var row = dt.row(tr);\n                var rowData = row.data() as IVStockDrug;\n                console.log(rowData)\n                if (row.child.isShown()) {\n                    // This row is already open - close it\n                    row.child.hide();\n                    tr.removeClass('shown');\n                }\n                else {\n                    // Open this row\n                    row.child(_this.getNewInnerTable(rowData)).show();\n                    tr.addClass('shown');\n                }\n\n\n                $btn.toggleClass('fa-plus-circle').toggleClass('fa-minus-circle');\n\n            });\n        },\n        makeDetailsColumn(row: IVStockDrug, index: number) {\n\n            const showInfoBtn = $(`<i class=\"fa fa-plus-circle  showVstockDetailsBtn\"></i>`);\n            return showInfoBtn.get(0).outerHTML;\n        },\n        tableCreatedRow(row: Node, data: IVStockDrug, dataIndex: number) {\n\n\n\n        }\n    }\n\n\n    const dtExecuter = new DatatableExecuter(\n        $tableDomEl,\n        Urls.getVstockApiUrl,\n        vstockConfig._dataTable,\n        vstockConfig._columnDefs,\n        4,\n        $tableLoadingEl,\n        vstockConfig.tableCreatedRow as any,\n        (dt) => {\n            vstockConfig.handleDetailsColumnActions(dt);\n        }).start();\n\n\n}());"]}